import{r as b,v as f,j as e,Y as n,q as w,$ as k}from"./app-HFejvg3Q.js";import{L as v,P as y,B as C}from"./BookmarkButton-BwOK3Rvy.js";import{C as _}from"./CommentForm-DAWzeW5K.js";import{B as L}from"./Base-Es5Nzz9X.js";import"./index.es-cpT-Y_vC.js";import"./Footer-DU1nN2KW.js";import"./Header-CbzPk8Rk.js";import"./TextInput-gL0HOBcG.js";function N({comment:s,auth:i,postId:o}){const m=o||s.post_id,[c,d]=b.useState(!1),[g,h]=b.useState(!1),{data:u,setData:x,post:p,processing:a,reset:r}=f({contenus:"",parent_id:s.id??"",post_id:o||s.post_id}),t=l=>{l.preventDefault(),p(route("comments.store",{post:m}),{preserveScroll:!0,onSuccess:j=>{r("contenus"),h(!1),d(!0),j.props.comment&&(s.replies=[...s.replies||[],j.props.comment],s.replies_count=(s.replies_count||0)+1)}})};return e.jsx("div",{className:"pb-4 last:pb-0",children:e.jsxs("div",{className:"flex gap-3",children:[e.jsx(n,{href:route("users.show",{user:`${s.user.name.toLowerCase().replace(/\s+/g,"-")}-${s.user.id}`}),className:"flex-shrink-0",children:e.jsx("div",{className:"avatar",children:e.jsxs("div",{className:"w-10 rounded-full",children:[e.jsx("img",{src:s.user.image||`https://ui-avatars.com/api/?name=${encodeURIComponent(s.user.name)}`,alt:s.user.name}),s.user.image&&e.jsx("figure",{className:"mb-6 rounded-lg overflow-hidden",children:e.jsx("img",{src:s.user.image,alt:s.title,className:"w-full h-auto max-h-[32rem] object-cover"})})]})})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(n,{href:route("users.show",{user:`${s.user.name.toLowerCase().replace(/\s+/g,"-")}-${s.user.id}`}),className:"font-semibold hover:text-primary hover:underline",children:s.user.name}),e.jsx("span",{className:"text-sm opacity-70",children:s.created_at})]}),e.jsx("p",{className:"mt-1",children:s.contenus}),e.jsxs("div",{className:"flex items-center gap-4 mt-2 text-sm",children:[e.jsx(v,{likeableId:s.id,likeableType:"App\\Models\\Commentaire",initialLikes:s.stats.likes_count,initialIsLiked:s.has_liked}),s.replies&&s.replies.length>0&&e.jsxs("button",{onClick:()=>d(!c),className:"flex items-center gap-1 hover:text-primary",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 10h.01M12 10h.01M16 10h.01M9 16H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-5l-5 5v-5z"})}),e.jsxs("span",{children:[s.replies_count||s.replies.length," réponses"]})]}),i.user&&e.jsx("button",{onClick:()=>h(!g),className:"hover:text-primary hover:underline",children:"Répondre"})]}),g&&i.user&&e.jsxs("form",{className:"mt-4 flex gap-3",onSubmit:t,children:[e.jsx("div",{className:"avatar flex-shrink-0",children:e.jsx("div",{className:"w-8 rounded-full",children:e.jsx("img",{src:i.user.avatar||`https://ui-avatars.com/api/?name=${encodeURIComponent(i.user.name)}`,alt:i.user.name})})}),e.jsxs("div",{className:"flex-1 flex gap-2",children:[e.jsx("input",{type:"text",name:"contenus",value:u.contenus,onChange:l=>x("contenus",l.target.value),placeholder:"Écrire une réponse...",className:"input input-bordered input-sm w-full",required:!0}),e.jsx("button",{type:"submit",className:"btn btn-primary btn-sm",disabled:a,children:a?"Envoi...":"Envoyer"})]})]}),c&&s.replies&&s.replies.length>0&&e.jsx("div",{className:"mt-3 pl-4 border-l-2 border-base-200 space-y-3",children:s.replies.map(l=>e.jsx(N,{comment:l,auth:i,postId:m},l.id))})]})]})})}function P({post:s,categories:i}){var u,x,p;const[o,m]=b.useState(!1),{auth:c}=w().props,d=o?s.comments:s.comments.slice(0,3),h=(a=>{const r=typeof a=="object"?a.titre:a;return`language-${String(r).toLowerCase().trim().replace(/\s+/g,"-")}`})({id:s.categorie.id,titre:s.categorie.titre});return e.jsxs(L,{children:[e.jsxs(k,{children:[e.jsx("title",{children:s.title}),e.jsx("meta",{name:"description",content:s.meta})]}),e.jsx("div",{className:"container mx-auto px-4 py-8 ",children:e.jsxs("div",{className:"flex flex-col lg:flex-row gap-8 ",children:[e.jsxs("div",{className:"lg:w-2/3 ",children:[e.jsxs("article",{className:"card  shadow-md p-6 mb-8 bg-base-200",children:[e.jsxs("header",{className:"mb-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs(n,{href:route("users.show",{user:`${s.author.name.toLowerCase().replace(/\s+/g,"-")}-${s.author.id}`}),className:"flex items-center gap-3 group",children:[e.jsx("div",{className:"avatar",children:e.jsx("div",{className:"w-12 rounded-full",children:e.jsx("img",{src:s.author.image||`https://ui-avatars.com/api/?name=${s.author.name}`,alt:s.author.name})})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold group-hover:text-primary transition",children:s.author.name}),e.jsx("time",{dateTime:s.published_at.datetime,className:"text-sm text-gray-500",children:s.published_at.formatted})]})]}),e.jsx("div",{className:"flex gap-2",children:(u=s.tags)==null?void 0:u.map(a=>e.jsxs(n,{className:"badge badge-outline hover:badge-primary transition",children:["#",a.name]},a.id))})]}),e.jsx("h1",{className:"text-3xl font-bold mb-4",children:s.title})]}),s.image&&e.jsx("figure",{className:"mb-6 rounded-lg overflow-hidden",children:e.jsx("img",{src:s.image,alt:s.title,className:"w-full h-auto max-h-[32rem] object-cover"})}),s.video_url&&e.jsx("div",{className:"aspect-w-16 aspect-h-9 mb-6",children:e.jsx("iframe",{src:s.video_url,className:"w-full h-[32rem] rounded-lg",allowFullScreen:!0})}),e.jsx("div",{className:"prose max-w-none mb-8  shadow-lg shadow-base-100 px-4 py-4",dangerouslySetInnerHTML:{__html:s.contenus}}),s.codesource&&e.jsx(y,{code:s.codesource,language:h}),e.jsxs("div",{className:"flex items-center justify-between border-t border-b border-base-300 py-4 my-6",children:[e.jsxs("div",{className:"flex items-center gap-6 ",children:[e.jsx(v,{likeableId:s.id,likeableType:"App\\Models\\Post",initialLikes:s.stats.likes_count,initialIsLiked:s.has_liked}),e.jsx(C,{bookmarkableId:s.id,bookmarkableType:"App\\Models\\Post",initialIsBookmarked:s.is_bookmarked}),e.jsxs("button",{className:"btn btn-ghost btn-sm gap-2 bg-base-100",children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"})}),e.jsx("span",{children:s.stats.comments_count})]}),s.tags&&s.tags.length>0&&e.jsx("div",{className:"mt-2 flex flex-wrap gap-2",children:(x=s.tags)==null?void 0:x.map(a=>{const r=["badge-primary","badge-secondary","badge-accent","badge-info","badge-success","badge-warning","badge-error","badge-ghost"],t=Math.abs(a.name.split("").reduce((l,j)=>l+j.charCodeAt(0),0))%r.length;return e.jsx(n,{className:`badge ${r[t]} hover:opacity-80 transition-opacity`,children:a.name},a.id)})})]}),e.jsxs("div",{className:"text-sm",children:[e.jsx("div",{className:`text-sm badge me-9 badge-${s.categorie.couleur}`,children:s.categorie.titre}),s.stats.views_count," vues"]})]})]}),e.jsxs("section",{className:"card bg-base-200 shadow-md p-6 mb-8",children:[e.jsxs("h2",{className:"text-xl font-bold mb-6",children:["Commentaires (",s.all_comments_count,")"]}),c.user&&e.jsx(_,{postId:s.id}),!c.user&&e.jsx("div",{className:"relative mb-5 h-12",children:e.jsx("textarea",{type:"text",readOnly:!0,defaultValue:"Connectez - vous pour placer un commentaire",className:"textarea textarea-error w-full p-3 pr-16 border rounded-lg resize-none transition-all absolute top-0 left-0",rows:"2"})}),e.jsx("div",{className:"space-y-6 mt-6",children:d==null?void 0:d.map(a=>e.jsx(N,{comment:a,auth:c},a.id))}),s.all_comments_count>3&&!o&&e.jsxs("button",{onClick:()=>m(!0),className:"btn btn-link mt-4",children:["Voir tous les commentaires (",s.all_comments_count,")"]})]})]}),e.jsx("div",{className:"lg:w-1/3",children:e.jsxs("div",{className:"sticky top-4 space-y-6",children:[s.related_posts.length>0&&e.jsxs("div",{className:"card bg-base-200 shadow-md p-6",children:[e.jsx("h3",{className:"text-xl font-bold mb-4",children:"Articles similaires"}),e.jsx("div",{className:"space-y-4",children:(p=s.related_posts)==null?void 0:p.map(a=>{var r;return e.jsxs(n,{href:route("posts.show",a.slug),className:"block group",children:[e.jsxs("div",{className:"flex gap-3",children:[a.image?e.jsx("div",{className:"w-20 h-20 flex-shrink-0 rounded overflow-hidden",children:e.jsx("img",{src:a.image,alt:a.title,className:"w-full h-full object-cover"})}):e.jsx("div",{className:"avatar avatar-placeholder",children:e.jsx("div",{className:"bg-primary text-primary-content w-12 rounded-full",children:e.jsx("span",{children:a.title.substring(0,2)})})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold group-hover:text-primary transition",children:a.title}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsx("div",{className:"avatar",children:e.jsx("div",{className:"w-6 rounded-full",children:e.jsx("img",{src:a.author.image||`https://ui-avatars.com/api/?name=${a.author.name}`,alt:a.author.name})})}),e.jsx("span",{className:"text-sm text-gray-600",children:a.author.name})]})]})]}),e.jsx("div",{className:"flex gap-1 mt-1",children:(r=a.tags)==null?void 0:r.map(t=>e.jsxs("div",{className:"badge badge-xs badge-info",children:["#",t.name]},t.id))})]},a.id)})})]}),e.jsxs("div",{className:"card bg-base-200 shadow-md p-6",children:[e.jsx("h3",{className:"text-xl font-bold mb-4",children:"À propos de l'auteur"}),e.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[e.jsx("div",{className:"avatar",children:e.jsx("div",{className:"w-16 rounded-full",children:e.jsx("img",{src:s.author.image||`https://ui-avatars.com/api/?name=${s.author.name}`,alt:s.author.name})})}),e.jsx("div",{children:e.jsx("h4",{className:"font-bold",children:s.author.name})})]}),s.author.bio&&e.jsx("p",{className:"text-opacity-1",children:s.author.bio}),e.jsx(n,{href:route("users.show",{user:`${s.author.name.toLowerCase().replace(/\s+/g,"-")}-${s.author.id}`}),className:"btn btn-outline btn-sm mt-4",children:"Voir le profil"})]})]})})]})})]})}export{P as default};
