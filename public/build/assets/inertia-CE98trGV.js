const G=(e,t,n)=>n>t?t:n<e?e:n,O=e=>e*1e3,q=e=>e/1e3;function L(e,t){return t?e*(1e3/t):0}const N=(e,t,n=10)=>{let s="";const o=Math.max(Math.round(t/n),2);for(let u=0;u<o;u++)s+=e(u/(o-1))+", ";return`linear(${s.substring(0,s.length-2)})`},B=2e4;function P(e){let t=0;const n=50;let s=e.next(t);for(;!s.done&&t<B;)t+=n,s=e.next(t);return t>=B?1/0:t}function V(e,t=100,n){const s=n({...e,keyframes:[0,t]}),o=Math.min(P(s),B);return{type:"keyframes",ease:u=>s.next(o*u).value/t,duration:q(o)}}const $=5;function E(e,t,n){const s=Math.max(t-$,0);return L(n-e(s),t-s)}const i={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},A=.001;function j({duration:e=i.duration,bounce:t=i.bounce,velocity:n=i.velocity,mass:s=i.mass}){let o,u,l=1-t;l=G(i.minDamping,i.maxDamping,l),e=G(i.minDuration,i.maxDuration,q(e)),l<1?(o=c=>{const y=c*l,p=y*e,g=y-n,b=R(c,l),D=Math.exp(-p);return A-g/b*D},u=c=>{const p=c*l*e,g=p*n+n,b=Math.pow(l,2)*Math.pow(c,2)*e,D=Math.exp(-p),f=R(Math.pow(c,2),l);return(-o(c)+A>0?-1:1)*((g-b)*D)/f}):(o=c=>{const y=Math.exp(-c*e),p=(c-n)*e+1;return-.001+y*p},u=c=>{const y=Math.exp(-c*e),p=(n-c)*(e*e);return y*p});const h=5/e,M=U(o,u,h);if(e=O(e),isNaN(M))return{stiffness:i.stiffness,damping:i.damping,duration:e};{const c=Math.pow(M,2)*s;return{stiffness:c,damping:l*2*Math.sqrt(s*c),duration:e}}}const C=12;function U(e,t,n){let s=n;for(let o=1;o<C;o++)s=s-e(s)/t(s);return s}function R(e,t){return e*Math.sqrt(1-t*t)}const z=["duration","bounce"],H=["stiffness","damping","mass"];function I(e,t){return t.some(n=>e[n]!==void 0)}function J(e){let t={velocity:i.velocity,stiffness:i.stiffness,damping:i.damping,mass:i.mass,isResolvedFromDuration:!1,...e};if(!I(e,H)&&I(e,z))if(e.visualDuration){const n=e.visualDuration,s=2*Math.PI/(n*1.2),o=s*s,u=2*G(.05,1,1-(e.bounce||0))*Math.sqrt(o);t={...t,mass:i.mass,stiffness:o,damping:u}}else{const n=j(e);t={...t,...n,mass:i.mass},t.isResolvedFromDuration=!0}return t}function F(e=i.visualDuration,t=i.bounce){const n=typeof e!="object"?{visualDuration:e,keyframes:[0,1],bounce:t}:e;let{restSpeed:s,restDelta:o}=n;const u=n.keyframes[0],l=n.keyframes[n.keyframes.length-1],h={done:!1,value:u},{stiffness:M,damping:c,mass:y,duration:p,velocity:g,isResolvedFromDuration:b}=J({...n,velocity:-q(n.velocity||0)}),D=g||0,f=c/(2*Math.sqrt(M*y)),v=l-u,m=q(Math.sqrt(M/y)),w=Math.abs(v)<5;s||(s=w?i.restSpeed.granular:i.restSpeed.default),o||(o=w?i.restDelta.granular:i.restDelta.default);let S;if(f<1){const a=R(m,f);S=d=>{const x=Math.exp(-f*m*d);return l-x*((D+f*m*v)/a*Math.sin(a*d)+v*Math.cos(a*d))}}else if(f===1)S=a=>l-Math.exp(-m*a)*(v+(D+m*v)*a);else{const a=m*Math.sqrt(f*f-1);S=d=>{const x=Math.exp(-f*m*d),r=Math.min(a*d,300);return l-x*((D+f*m*v)*Math.sinh(r)+a*v*Math.cosh(r))/a}}const k={calculatedDuration:b&&p||null,next:a=>{const d=S(a);if(b)h.done=a>=p;else{let x=a===0?D:0;f<1&&(x=a===0?O(D):E(S,a,d));const r=Math.abs(x)<=s,T=Math.abs(l-d)<=o;h.done=r&&T}return h.value=h.done?l:d,h},toString:()=>{const a=Math.min(P(k),B),d=N(x=>k.next(a*x).value,a,30);return a+"ms "+d},toTransition:()=>{}};return k}F.applyToOptions=e=>{const t=V(e,100,F);return e.ease=t.ease,e.duration=O(t.duration),e.type="keyframes",e};function Q({keyframes:e,velocity:t=0,power:n=.8,timeConstant:s=325,bounceDamping:o=10,bounceStiffness:u=500,modifyTarget:l,min:h,max:M,restDelta:c=.5,restSpeed:y}){const p=e[0],g={done:!1,value:p},b=r=>h!==void 0&&r<h||M!==void 0&&r>M,D=r=>h===void 0?M:M===void 0||Math.abs(h-r)<Math.abs(M-r)?h:M;let f=n*t;const v=p+f,m=l===void 0?v:l(v);m!==v&&(f=m-p);const w=r=>-f*Math.exp(-r/s),S=r=>m+w(r),k=r=>{const T=w(r),K=S(r);g.done=Math.abs(T)<=c,g.value=g.done?m:K};let a,d;const x=r=>{b(g.value)&&(a=r,d=F({keyframes:[g.value,D(g.value)],velocity:E(S,r,g.value),damping:o,stiffness:u,restDelta:c,restSpeed:y}))};return x(0),{calculatedDuration:null,next:r=>{let T=!1;return!d&&a===void 0&&(T=!0,k(r),x(r)),a!==void 0&&r>=a?d.next(r-a):(!T&&k(r),g)}}}export{P as a,O as b,G as c,N as g,Q as i,q as m,F as s,L as v};
