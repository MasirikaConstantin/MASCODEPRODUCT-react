import{q as b,v as f,j as e,r as g,Y as m,$ as y}from"./app-DtNHpPvx.js";import{A as k}from"./AuthenticatedLayout-JaK5UC7L.js";import{L as N,Q as C,P as _,B as $}from"./QuillContentViewer-DfxpM5eR.js";import{V as S}from"./Footer-B3kzTPXT.js";import"./Header-EDVoj_-P.js";import"./TextInput-B9dtHzvL.js";import"./index.es-PA0IHHkZ.js";function A({astuceId:s,parentId:a=null,onCancelReply:i=null}){const{auth:n}=b().props,{props:o}=b(),d=o.flash||{},{data:x,setData:c,post:h,processing:r,errors:t,reset:p}=f({contenus:"",astuce_id:s,parent_id:a}),j=u=>{u.preventDefault(),h(route("commentairesastuces.store"),{preserveScroll:!0,onSuccess:()=>{p("contenus"),S.success("Commentaire envoyé avec succes"),i&&i()},onError:()=>{const l=document.querySelector(".text-error");l&&l.scrollIntoView({behavior:"smooth",block:"center"})}})};return n.user?e.jsxs("div",{className:"mt-8",id:"comment-form",children:[d.success&&e.jsx("div",{className:"alert alert-success mb-4",children:e.jsx("div",{children:e.jsx("span",{children:d.success})})}),e.jsx("h3",{className:"text-xl font-semibold mb-4 text-base-content",children:a?"Répondre au commentaire":"Laisser un commentaire"}),e.jsxs("form",{onSubmit:j,className:"space-y-4",children:[e.jsxs("div",{className:"form-control",children:[e.jsx("textarea",{className:`textarea textarea-bordered h-24 ${t.contenus?"textarea-error":""}`,placeholder:"Votre commentaire...",value:x.contenus,onChange:u=>c("contenus",u.target.value),disabled:r}),t.contenus&&e.jsx("span",{className:"text-error text-sm mt-1 block",children:t.contenus})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{type:"submit",className:`btn btn-primary ${r?"loading":""}`,disabled:r,children:r?"":a?"Publier la réponse":"Publier le commentaire"}),a&&e.jsx("button",{type:"button",className:"btn btn-ghost",onClick:i,disabled:r,children:"Annuler"})]})]})]}):e.jsx("div",{className:"mt-8",children:e.jsx("div",{className:"alert alert-warning",children:e.jsxs("div",{children:[e.jsx("span",{children:"Vous devez être connecté pour commenter"}),e.jsx(Link,{href:route("login"),className:"link link-primary ml-2",children:"Se connecter"})]})})})}function w({comment:s,auth:a,astuceId:i}){const n=i||s.astuce_id,[o,d]=g.useState(!1),[x,c]=g.useState(!1),{data:h,setData:r,post:t,processing:p,reset:j}=f({contenus:"",parent_id:s.id??"",astuce_id:i||s.astuce_id}),u=l=>{l.preventDefault(),t(route("commentsastuces.store",{astuce:n}),{preserveScroll:!0,onSuccess:v=>{j("contenus"),c(!1),d(!0),v.props.comment&&(s.replies=[...s.replies||[],v.props.comment],s.replies_count=(s.replies_count||0)+1)}})};return e.jsx("div",{className:"pb-4 last:pb-0",children:e.jsxs("div",{className:"flex gap-3",children:[e.jsx(m,{href:route("users.show",{user:`${s.user.name.toLowerCase().replace(/\s+/g,"-")}-${s.user.id}`}),className:"flex-shrink-0",children:e.jsx("div",{className:"avatar",children:e.jsx("div",{className:"w-10 rounded-full",children:e.jsx("img",{src:s.user.avatar||`https://ui-avatars.com/api/?name=${encodeURIComponent(s.user.name)}`,alt:s.user.name})})})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(m,{href:route("users.show",{user:`${s.user.name.toLowerCase().replace(/\s+/g,"-")}-${s.user.id}`}),className:"font-semibold hover:text-primary hover:underline",children:s.user.name}),e.jsx("span",{className:"text-sm opacity-70",children:s.created_at})]}),e.jsx("p",{className:"mt-1",children:s.contenus}),e.jsxs("div",{className:"flex items-center gap-4 mt-2 text-sm",children:[e.jsx(N,{likeableId:s.id,likeableType:"App\\Models\\CommentaireAstuce",initialLikes:s.stats.likes_count,initialIsLiked:s.has_liked}),s.replies&&s.replies.length>0&&e.jsxs("button",{onClick:()=>d(!o),className:"flex items-center gap-1 hover:text-primary",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 10h.01M12 10h.01M16 10h.01M9 16H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-5l-5 5v-5z"})}),e.jsxs("span",{children:[s.replies_count||s.replies.length," réponses"]})]}),a.user&&e.jsx("button",{onClick:()=>c(!x),className:"hover:text-primary hover:underline",children:"Répondre"})]}),x&&a.user&&e.jsxs("form",{className:"mt-4 flex gap-3",onSubmit:u,children:[e.jsx("div",{className:"avatar flex-shrink-0",children:e.jsx("div",{className:"w-8 rounded-full",children:e.jsx("img",{src:a.user.avatar||`https://ui-avatars.com/api/?name=${encodeURIComponent(a.user.name)}`,alt:a.user.name})})}),e.jsxs("div",{className:"flex-1 flex gap-2",children:[e.jsx("input",{type:"text",name:"contenus",value:h.contenus,onChange:l=>r("contenus",l.target.value),placeholder:"Écrire une réponse...",className:"input input-bordered input-sm w-full",required:!0}),e.jsx("button",{type:"submit",className:"btn btn-primary btn-sm",disabled:p,children:p?"Envoi...":"Envoyer"})]})]}),o&&s.replies&&s.replies.length>0&&e.jsx("div",{className:"mt-3 pl-4 border-l-2 border-base-200 space-y-3",children:s.replies.map(l=>e.jsx(w,{comment:l,auth:a,astuceId:n},l.id))})]})]})})}function E({astuce:s}){var c,h,r;const[a,i]=g.useState(!1),{auth:n}=b().props,o=a?s.comments:(c=s.comments)==null?void 0:c.slice(0,3),x=(t=>{const p=typeof t=="object"?t.title:t;return`language-${String(p).toLowerCase().trim().replace(/\s+/g,"-")}`})(s.categorie);return e.jsxs(k,{children:[e.jsxs(y,{children:[e.jsx("title",{children:s.title}),e.jsx("meta",{name:"description",content:s.meta_description||s.title}),e.jsx("meta",{property:"og:title",content:s.title}),e.jsx("meta",{property:"og:description",content:s.meta_description||s.title}),e.jsx("meta",{property:"og:image",content:s.image||"https://autres.mascodeproduct.com/mas-product.ico"}),e.jsx("meta",{property:"og:url",content:window.location.href}),e.jsx("meta",{name:"twitter:card",content:"summary_large_image"}),e.jsx("meta",{name:"twitter:title",content:s.title}),e.jsx("meta",{name:"twitter:description",content:s.meta_description||s.title}),e.jsx("meta",{name:"twitter:image",content:s.image||"https://autres.mascodeproduct.com/mas-product.ico"}),e.jsx("meta",{name:"viewport",content:"width=device-width, initial-scale=1.0"})]}),e.jsxs("div",{className:"container mx-auto px-2 sm:px-4 py-4 sm:py-8",children:[e.jsx("div",{className:"text-xs sm:text-sm breadcrumbs mb-4 sm:mb-6 overflow-x-auto",children:e.jsxs("ul",{className:"whitespace-nowrap",children:[e.jsx("li",{children:e.jsx(m,{href:route("home"),children:"Accueil"})}),e.jsx("li",{children:e.jsx(m,{href:route("astuces.index"),children:"Astuces"})}),e.jsx("li",{className:"text-primary font-medium",children:s.title})]})}),e.jsxs("div",{className:"flex flex-col lg:flex-row gap-4 sm:gap-8",children:[e.jsxs("div",{className:"lg:w-2/3",children:[e.jsx("article",{className:"card bg-base-200 shadow-lg sm:shadow-xl",children:e.jsxs("div",{className:"card-body p-4 sm:p-6",children:[e.jsxs("header",{className:"mb-4 sm:mb-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3 mb-3 sm:mb-4",children:[e.jsxs(m,{href:route("users.show",{user:`${s.author.name.toLowerCase().replace(/\s+/g,"-")}-${s.author.id}`}),className:"flex items-center gap-2 sm:gap-3 group",children:[e.jsx("div",{className:"avatar",children:e.jsx("div",{className:"w-10 sm:w-12 rounded-full",children:s.author.image?e.jsx("img",{className:"w-full h-full object-cover transition-all duration-500 group-hover:scale-110",src:`${window.location.origin}/storage/${s.author.image}`,alt:s.titre}):e.jsx("img",{src:`https://ui-avatars.com/api/?name=${s.author.name}`,alt:s.author.name})})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-sm sm:text-base group-hover:text-primary transition",children:s.author.name}),e.jsx("time",{dateTime:s.created_at,className:"text-xs sm:text-sm text-gray-500",children:s.created_at})]})]}),e.jsx("div",{className:"flex flex-wrap gap-1 sm:gap-2",children:(h=s.tags)==null?void 0:h.map(t=>e.jsxs(m,{href:route("astuces.index",{tag:t.name}),className:"badge badge-outline text-xs sm:text-sm hover:badge-primary transition",children:["#",t.name]},t.id))})]}),e.jsx("h1",{className:"text-xl sm:text-2xl md:text-3xl font-bold mb-3 sm:mb-4",children:s.title}),e.jsx("div",{className:`badge badge-sm sm:badge-lg badge-${s.categorie.couleur||"primary"}`,children:s.categorie.titre})]}),s.image&&e.jsx("figure",{className:"mb-4 sm:mb-6 rounded-lg overflow-hidden",children:e.jsx("img",{src:s.image,alt:s.title,className:"w-full h-auto max-h-[20rem] sm:max-h-[32rem] object-cover"})}),s.video&&e.jsx("div",{className:"aspect-w-16 aspect-h-9 mb-4 sm:mb-6",children:e.jsx("iframe",{src:s.video.replace("watch?v=","embed/"),className:"w-full h-[18rem] sm:h-[32rem] rounded-lg",allowFullScreen:!0})}),e.jsx("div",{className:"prose max-w-none mb-6 sm:mb-8 text-sm sm:text-base",children:e.jsx(C,{content:s.contenus})}),s.codesource&&e.jsx(_,{code:s.codesource,language:x}),e.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-between border-t border-b border-base-300 py-3 sm:py-4 my-4 sm:my-6 gap-2 sm:gap-0",children:[e.jsxs("div",{className:"flex items-center gap-3 sm:gap-6",children:[e.jsxs("button",{className:"btn btn-ghost btn-xs sm:btn-sm gap-1 sm:gap-2 px-2 sm:px-4",children:[e.jsx("svg",{className:"w-4 h-4 sm:w-5 sm:h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"})}),e.jsx("span",{children:s.comments_count||0})]}),e.jsx(N,{likeableId:s.id,likeableType:"App\\Models\\Astuce",initialLikes:s.stats.likes_count,initialIsLiked:s.has_liked}),n.user&&e.jsx($,{bookmarkableId:s.id,bookmarkableType:"App\\Models\\Astuce",initialIsBookmarked:s.is_bookmarked})]}),e.jsxs("div",{className:"text-xs sm:text-sm",children:[s.stats.views_count||0," vues"]})]})]})}),e.jsx("section",{className:"card bg-base-100 shadow-lg sm:shadow-xl mt-6 sm:mt-8",children:e.jsxs("div",{className:"card-body p-4 sm:p-6",children:[e.jsxs("h2",{className:"text-lg sm:text-xl font-bold mb-4 sm:mb-6",children:["Commentaires (",s.comments_count||0,")"]}),n.user?e.jsx(A,{astuceId:s.id,className:"mb-4 sm:mb-6"}):e.jsx("div",{className:"alert alert-info mb-4 sm:mb-6 text-xs sm:text-sm",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"stroke-current flex-shrink-0 h-5 w-5",fill:"none",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),e.jsx("span",{children:"Connectez-vous pour poster un commentaire"})]})}),e.jsx("div",{className:"space-y-4 sm:space-y-6",children:o==null?void 0:o.map(t=>e.jsx(w,{comment:t,auth:n},t.id))}),s.comments_count>3&&!a&&e.jsxs("button",{onClick:()=>i(!0),className:"btn btn-link btn-sm sm:btn-md mt-3 sm:mt-4 px-0",children:["Voir tous les commentaires (",s.comments_count,")"]})]})})]}),e.jsx("div",{className:"lg:w-1/3 mt-4 sm:mt-0",children:e.jsxs("div",{className:"sticky top-2 sm:top-4 space-y-4 sm:space-y-6",children:[s.astucesLiees.length>0&&e.jsx("div",{className:"card bg-base-100 shadow-lg sm:shadow-xl",children:e.jsxs("div",{className:"card-body p-4 sm:p-6",children:[e.jsx("h3",{className:"text-lg sm:text-xl font-bold mb-3 sm:mb-4",children:"Astuces similaires"}),e.jsx("div",{className:"space-y-3 sm:space-y-4",children:(r=s.astucesLiees)==null?void 0:r.map(t=>e.jsx(m,{href:route("astuces.show",t.slug),className:"block group",children:e.jsxs("div",{className:"flex gap-2 sm:gap-3",children:[t.image?e.jsx("div",{className:"w-16 h-16 sm:w-20 sm:h-20 flex-shrink-0 rounded overflow-hidden",children:e.jsx("img",{src:t.image,alt:t.title,className:"w-full h-full object-cover"})}):e.jsx("div",{className:"avatar avatar-placeholder",children:e.jsx("div",{className:"bg-primary text-primary-content w-10 h-10 sm:w-12 sm:h-12 rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-xs sm:text-sm",children:t.title.substring(0,2)})})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h4",{className:"font-semibold text-sm sm:text-base group-hover:text-primary transition truncate",children:t.title}),e.jsxs("div",{className:"flex items-center gap-1 sm:gap-2 mt-1",children:[e.jsx("div",{className:"avatar",children:e.jsx("div",{className:"w-5 h-5 sm:w-6 sm:h-6 rounded-full",children:e.jsx("img",{src:t.author.image||`https://ui-avatars.com/api/?name=${t.author.name}`,alt:t.author.name})})}),e.jsx("span",{className:"text-xs sm:text-sm truncate",children:t.author.name})]})]})]})},t.id))})]})}),e.jsxs("div",{className:"card bg-base-200 shadow-md p-4 sm:p-6",children:[e.jsx("h3",{className:"text-lg sm:text-xl font-bold mb-3 sm:mb-4",children:"À propos de l'auteur"}),e.jsxs("div",{className:"flex items-center gap-3 sm:gap-4 mb-3 sm:mb-4",children:[e.jsx("div",{className:"avatar",children:e.jsx("div",{className:"w-12 h-12 sm:w-16 sm:h-16 rounded-full",children:s.author.image?e.jsx("img",{className:"w-full h-full object-cover",src:`${window.location.origin}/storage/${s.author.image}`,alt:s.titre}):e.jsx("img",{src:`https://ui-avatars.com/api/?name=${s.author.name}`,alt:s.author.name})})}),e.jsx("div",{children:e.jsx("h4",{className:"font-bold text-sm sm:text-base",children:s.author.name})})]}),s.author.bio&&e.jsx("p",{className:"text-opacity-1 text-xs sm:text-sm",children:s.author.bio}),e.jsx(m,{href:route("users.show",{user:`${s.author.name.toLowerCase().replace(/\s+/g,"-")}-${s.author.id}`}),className:"btn btn-outline btn-xs sm:btn-sm mt-3 sm:mt-4",children:"Voir le profil"})]})]})})]})]})]})}export{E as default};
