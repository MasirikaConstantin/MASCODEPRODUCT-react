import{r as b,v as N,j as e,Y as m,q as w,$ as y}from"./app-Dvltrqi_.js";import{L as v,Q as k,P as C,B as _}from"./QuillContentViewer-BPcTIk1S.js";import{C as $}from"./CommentForm-Bza9VKX5.js";import{B as L}from"./Base-HHvR5O9m.js";import"./index.es-DLJBjQjN.js";import"./Footer-Cnzt67JZ.js";import"./Header-DuCTLyD2.js";import"./TextInput-B7LrDYCx.js";function f({comment:s,auth:l,postId:d}){const o=d||s.post_id,[n,c]=b.useState(!1),[g,x]=b.useState(!1),{data:h,setData:u,post:p,processing:a,reset:t}=N({contenus:"",parent_id:s.id??"",post_id:d||s.post_id}),i=r=>{r.preventDefault(),p(route("comments.store",{post:o}),{preserveScroll:!0,onSuccess:j=>{t("contenus"),x(!1),c(!0),j.props.comment&&(s.replies=[...s.replies||[],j.props.comment],s.replies_count=(s.replies_count||0)+1)}})};return e.jsx("div",{className:"pb-4 last:pb-0 mt-4",children:e.jsxs("div",{className:"flex gap-3",children:[e.jsx(m,{href:route("users.show",{user:`${s.user.name.toLowerCase().replace(/\s+/g,"-")}-${s.user.id}`}),className:"flex-shrink-0",children:e.jsx("div",{className:"avatar",children:e.jsxs("div",{className:"w-10 rounded-full",children:[e.jsx("img",{src:s.user.image||`https://ui-avatars.com/api/?name=${encodeURIComponent(s.user.name)}`,alt:s.user.name}),s.user.image&&e.jsx("figure",{className:"mb-6 rounded-lg overflow-hidden",children:e.jsx("img",{src:s.user.image,alt:s.title,className:"w-full h-auto max-h-[32rem] object-cover"})})]})})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(m,{href:route("users.show",{user:`${s.user.name.toLowerCase().replace(/\s+/g,"-")}-${s.user.id}`}),className:"font-semibold hover:text-primary hover:underline",children:s.user.name}),e.jsx("span",{className:"text-sm opacity-70",children:s.created_at})]}),e.jsx("p",{className:"mt-1",children:s.contenus}),e.jsxs("div",{className:"flex items-center gap-4 mt-2 text-sm",children:[e.jsx(v,{likeableId:s.id,likeableType:"App\\Models\\Commentaire",initialLikes:s.stats.likes_count,initialIsLiked:s.has_liked}),s.replies&&s.replies.length>0&&e.jsxs("button",{onClick:()=>c(!n),className:"flex items-center gap-1 hover:text-primary",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 10h.01M12 10h.01M16 10h.01M9 16H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-5l-5 5v-5z"})}),e.jsxs("span",{children:[s.replies_count||s.replies.length," réponses"]})]}),l.user&&e.jsx("button",{onClick:()=>x(!g),className:"hover:text-primary hover:underline",children:"Répondre"})]}),g&&l.user&&e.jsxs("form",{className:"mt-4 flex gap-3",onSubmit:i,children:[e.jsx("div",{className:"avatar flex-shrink-0",children:e.jsx("div",{className:"w-8 rounded-full",children:e.jsx("img",{src:l.user.avatar||`https://ui-avatars.com/api/?name=${encodeURIComponent(l.user.name)}`,alt:l.user.name})})}),e.jsxs("div",{className:"flex-1 flex gap-2",children:[e.jsx("input",{type:"text",name:"contenus",value:h.contenus,onChange:r=>u("contenus",r.target.value),placeholder:"Écrire une réponse...",className:"input input-bordered input-sm w-full",required:!0}),e.jsx("button",{type:"submit",className:"btn btn-primary btn-sm",disabled:a,children:a?"Envoi...":"Envoyer"})]})]}),n&&s.replies&&s.replies.length>0&&e.jsx("div",{className:"mt-3 pl-4 border-l-2 border-base-200 space-y-3",children:s.replies.map(r=>e.jsx(f,{comment:r,auth:l,postId:o},r.id))})]})]})})}function V({post:s,categories:l}){var h,u,p;const[d,o]=b.useState(!1),{auth:n}=w().props,c=d?s.comments:s.comments.slice(0,3),x=(a=>{const t=typeof a=="object"?a.titre:a;return`language-${String(t).toLowerCase().trim().replace(/\s+/g,"-")}`})({id:s.categorie.id,titre:s.categorie.titre});return e.jsxs(L,{children:[e.jsxs(y,{children:[e.jsx("title",{children:s.title}),e.jsx("meta",{name:"description",content:s.meta}),e.jsx("meta",{property:"og:title",content:s.title}),e.jsx("meta",{property:"og:description",content:s.meta}),e.jsx("meta",{property:"og:image",content:s.image||"https://autres.mascodeproduct.com/mas-product.ico"}),e.jsx("meta",{property:"og:url",content:route("posts.show",s.slug)}),e.jsx("meta",{name:"twitter:card",content:"summary_large_image"}),e.jsx("meta",{name:"twitter:title",content:s.title}),e.jsx("meta",{name:"twitter:description",content:s.meta}),e.jsx("meta",{name:"twitter:image",content:s.image||"https://autres.mascodeproduct.com/mas-product.ico"}),e.jsx("meta",{name:"viewport",content:"width=device-width, initial-scale=1.0"})]}),e.jsx("div",{className:"container mx-auto  sm:px-4 py-4 sm:py-6",children:e.jsxs("div",{className:"flex flex-col lg:flex-row gap-2 sm:gap-6",children:[e.jsxs("div",{className:"lg:w-2/3",children:[e.jsxs("article",{className:"card shadow-sm sm:shadow-md p-4 sm:p-6 mb-6 sm:mb-8 bg-base-200",children:[e.jsxs("header",{className:"mb-4 sm:mb-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-3 mb-3 sm:mb-4",children:[e.jsxs(m,{href:route("users.show",{user:`${s.author.name.toLowerCase().replace(/\s+/g,"-")}-${s.author.id}`}),className:"flex items-center gap-2 sm:gap-3 group",children:[e.jsx("div",{className:"avatar",children:e.jsx("div",{className:"w-10 sm:w-12 rounded-full",children:e.jsx("img",{src:s.author.image||`https://ui-avatars.com/api/?name=${s.author.name}`,alt:s.author.name,className:"object-cover"})})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-sm sm:text-base group-hover:text-primary transition",children:s.author.name}),e.jsx("time",{dateTime:s.published_at.datetime,className:"text-xs sm:text-sm text-gray-500",children:s.published_at.formatted})]})]}),e.jsx("div",{className:"flex flex-wrap gap-1 sm:gap-2 justify-end",children:(h=s.tags)==null?void 0:h.map(a=>e.jsxs(m,{className:"badge badge-outline text-xs hover:badge-primary transition",children:["#",a.name]},a.id))})]}),e.jsx("h1",{className:"text-xl sm:text-2xl md:text-3xl font-bold mb-3 sm:mb-4",children:s.title})]}),s.image&&e.jsx("figure",{className:"mb-4 sm:mb-6 rounded-lg overflow-hidden",children:e.jsx("img",{src:s.image,alt:s.title,className:"w-full h-auto max-h-[20rem] sm:max-h-[32rem] object-cover"})}),s.video_url&&e.jsx("div",{className:"aspect-w-16 aspect-h-9 mb-4 sm:mb-6",children:e.jsx("iframe",{src:s.video_url,className:"w-full h-[16rem] sm:h-[24rem] md:h-[32rem] rounded-lg",allowFullScreen:!0})}),e.jsx("div",{className:" ",children:e.jsx(k,{content:s.contenus})}),s.codesource&&e.jsx("div",{className:"mb-6 sm:mb-8",children:e.jsx(C,{code:s.codesource,language:x})}),e.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-between border-t border-b border-base-300 py-3 sm:py-4 my-4 sm:my-6 gap-3 sm:gap-0",children:[e.jsxs("div",{className:"flex items-center gap-2 sm:gap-4 flex-wrap justify-center sm:justify-start",children:[e.jsx(v,{likeableId:s.id,likeableType:"App\\Models\\Post",initialLikes:s.stats.likes_count,initialIsLiked:s.has_liked}),n.user&&e.jsx(_,{bookmarkableId:s.id,bookmarkableType:"App\\Models\\Post",initialIsBookmarked:s.is_bookmarked}),e.jsxs("button",{className:"btn btn-ghost btn-xs sm:btn-sm gap-1 sm:gap-2 px-2 sm:px-3",children:[e.jsx("svg",{className:"w-4 h-4 sm:w-5 sm:h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"})}),e.jsx("span",{children:s.stats.comments_count})]}),s.tags&&s.tags.length>0&&e.jsx("div",{className:"flex flex-wrap gap-1 sm:gap-2",children:(u=s.tags)==null?void 0:u.map(a=>{const t=["badge-primary","badge-secondary","badge-accent","badge-info","badge-success","badge-warning","badge-error","badge-ghost"],i=Math.abs(a.name.split("").reduce((r,j)=>r+j.charCodeAt(0),0))%t.length;return e.jsx(m,{className:`badge text-xs ${t[i]} hover:opacity-80 transition-opacity`,children:a.name},a.id)})})]}),e.jsxs("div",{className:"flex items-center gap-2 text-xs sm:text-sm mt-2 sm:mt-0",children:[e.jsx("div",{className:`badge me-1 sm:me-2 badge-${s.categorie.couleur} text-xs`,children:s.categorie.titre}),s.stats.views_count," vues"]})]})]}),e.jsxs("section",{className:"card bg-base-200 shadow-sm sm:shadow-md p-4 sm:p-6 mb-6 sm:mb-8",children:[e.jsxs("h2",{className:"text-lg sm:text-xl font-bold mb-4 sm:mb-6",children:["Commentaires (",s.all_comments_count,")"]}),n.user?e.jsx($,{postId:s.id,className:"mb-4 sm:mb-6"}):e.jsx("div",{className:"relative mb-4 h-12",children:e.jsx("textarea",{type:"text",readOnly:!0,defaultValue:"Connectez-vous pour commenter",className:"textarea textarea-bordered w-full p-3 pr-16 rounded-lg resize-none transition-all absolute top-0 left-0 text-xs sm:text-sm",rows:"2"})}),e.jsx("div",{className:"space-y-4 sm:space-y-6 mt-4 sm:mt-6",children:c==null?void 0:c.map(a=>e.jsx(f,{comment:a,auth:n},a.id))}),s.all_comments_count>3&&!d&&e.jsxs("button",{onClick:()=>o(!0),className:"btn btn-link btn-sm sm:btn-md mt-3 sm:mt-4 px-0 text-xs sm:text-sm",children:["Voir tous les commentaires (",s.all_comments_count,")"]})]})]}),e.jsx("div",{className:"lg:w-1/3",children:e.jsxs("div",{className:"sticky top-2 sm:top-4 space-y-4 sm:space-y-6",children:[s.related_posts.length>0&&e.jsxs("div",{className:"card bg-base-200 shadow-sm sm:shadow-md p-4 sm:p-6",children:[e.jsx("h3",{className:"text-lg sm:text-xl font-bold mb-3 sm:mb-4",children:"Articles similaires"}),e.jsx("div",{className:"space-y-3 sm:space-y-4",children:(p=s.related_posts)==null?void 0:p.map(a=>{var t;return e.jsxs(m,{href:route("posts.show",a.slug),className:"block group",children:[e.jsxs("div",{className:"flex gap-2 sm:gap-3",children:[a.image?e.jsx("div",{className:"w-16 h-16 sm:w-20 sm:h-20 flex-shrink-0 rounded overflow-hidden",children:e.jsx("img",{src:a.image,alt:a.title,className:"w-full h-full object-cover"})}):e.jsx("div",{className:"avatar avatar-placeholder",children:e.jsx("div",{className:"bg-primary text-primary-content w-12 h-12 sm:w-14 sm:h-14 rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-xs sm:text-sm",children:a.title.substring(0,2)})})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h4",{className:"font-semibold text-sm sm:text-base group-hover:text-primary transition line-clamp-2",children:a.title}),e.jsxs("div",{className:"flex items-center gap-1 sm:gap-2 mt-1",children:[e.jsx("div",{className:"avatar",children:e.jsx("div",{className:"w-5 h-5 sm:w-6 sm:h-6 rounded-full",children:e.jsx("img",{src:a.author.image||`https://ui-avatars.com/api/?name=${a.author.name}`,alt:a.author.name})})}),e.jsx("span",{className:"text-xs sm:text-sm text-gray-600 truncate",children:a.author.name})]})]})]}),e.jsx("div",{className:"flex gap-1 mt-1 flex-wrap",children:(t=a.tags)==null?void 0:t.map(i=>e.jsxs("div",{className:"badge badge-xs badge-info",children:["#",i.name]},i.id))})]},a.id)})})]}),e.jsxs("div",{className:"card bg-base-200 shadow-sm sm:shadow-md p-4 sm:p-6",children:[e.jsx("h3",{className:"text-lg sm:text-xl font-bold mb-3 sm:mb-4",children:"À propos de l'auteur"}),e.jsxs("div",{className:"flex items-center gap-3 sm:gap-4 mb-3 sm:mb-4",children:[e.jsx("div",{className:"avatar",children:e.jsx("div",{className:"w-12 h-12 sm:w-16 sm:h-16 rounded-full",children:e.jsx("img",{src:s.author.image||`https://ui-avatars.com/api/?name=${s.author.name}`,alt:s.author.name,className:"object-cover"})})}),e.jsx("div",{children:e.jsx("h4",{className:"font-bold text-sm sm:text-base",children:s.author.name})})]}),s.author.bio&&e.jsx("p",{className:"text-opacity-1 text-xs sm:text-sm",children:s.author.bio}),e.jsx(m,{href:route("users.show",{user:`${s.author.name.toLowerCase().replace(/\s+/g,"-")}-${s.author.id}`}),className:"btn btn-outline btn-xs sm:btn-sm mt-3 sm:mt-4",children:"Voir le profil"})]})]})})]})})]})}export{V as default};
