import{q as g,r as n,v as w,j as e,$ as k}from"./app-Dvltrqi_.js";import{A as C}from"./AuthenticatedLayout-DhV7mN7H.js";import"./Footer-Cnzt67JZ.js";import"./Header-DuCTLyD2.js";import"./TextInput-B7LrDYCx.js";function A(){const{categories:m,tags:p,errors:x}=g().props,[u,f]=n.useState(null),[h,b]=n.useState({}),d=n.useRef(null),{data:s,setData:a,post:j,processing:c}=w({titre:"",contenus:"",user_id:g().props.auth.user.id,image:null,slug:"",codesource:"",categorie_id:"",tags:[],etat:"0"}),o=()=>{const t={};return s.titre.trim()?s.titre.length<4&&(t.titre="Le titre doit faire au moins 4 caractères"):t.titre="Le titre est obligatoire",s.contenus.trim()?s.contenus.length<4&&(t.contenus="Le contenus doit faire au moins 4 caractères"):t.contenus="Le contenus est obligatoire",s.slug.trim()?s.slug.length<8?t.slug="Le slug doit faire au moins 8 caractères":/^[0-9a-z\-]+$/.test(s.slug)||(t.slug="Le slug ne doit contenir que des lettres minuscules, chiffres et tirets"):t.slug="Le slug est obligatoire",s.categorie_id||(t.categorie_id="La catégorie est obligatoire"),s.tags.length||(t.tags="Au moins un tag est obligatoire"),b(t),Object.keys(t).length===0},v=t=>{t.preventDefault(),o()&&j(route("posts.store"),{preserveScroll:!0,onError:l=>{console.error("Server errors:",l)}})},N=t=>{const l=t.target.files[0];if(l){a("image",l);const i=new FileReader;i.onloadend=()=>{f(i.result)},i.readAsDataURL(l)}};n.useEffect(()=>{if(s.titre){const t=s.titre.toLowerCase().replace(/[^a-z0-9 -]/g,"").replace(/\s+/g,"-").replace(/-+/g,"-");a("slug",t)}},[s.titre]);const r={...h,...x};return e.jsxs(C,{children:[e.jsx(k,{title:"Créer un nouveau post"}),e.jsx("main",{className:"min-h-screen  py-12 px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"max-w-5xl mx-auto ",children:[e.jsx("h1",{className:"text-4xl font-extrabold  mb-8",children:"Créer un nouveau post"}),e.jsxs("form",{onSubmit:v,encType:"multipart/form-data",className:"space-y-8 bg-base-200  rounded-2xl p-8 shadow-xl",children:[e.jsx("input",{type:"hidden",name:"user_id",value:s.user_id}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"text",name:"titre",value:s.titre,onChange:t=>a("titre",t.target.value),onBlur:()=>o(),className:"block px-2.5 pb-2.5 pt-4 w-full text-sm  bg-transparent rounded-lg border-1  appearance-none dark:text-white dark:border-gray-600 dark:focus:border-blue-500 focus:outline-none focus:ring-0 focus:border-blue-600 peer",placeholder:" ",id:"titre"}),e.jsx("label",{htmlFor:"titre",className:"absolute text-sm  duration-300 transform -translate-y-4 bg-gray-400 scale-75 top-2 z-10 origin-[0] dark:bg-gray-900 px-2 peer-focus:px-2 peer-focus:text-blue-600 peer-focus:dark:text-blue-500 peer-placeholder-shown:scale-100 peer-placeholder-shown:-translate-y-1/2 peer-placeholder-shown:top-1/2 peer-focus:top-2 peer-focus:scale-75 peer-focus:-translate-y-4 rtl:peer-focus:translate-x-1/4 rtl:peer-focus:left-auto start-1",children:"Titre *"}),r.titre&&e.jsx("p",{className:"mt-2 text-red-500 text-sm",children:r.titre})]}),e.jsxs("div",{className:"relative",children:[e.jsxs("select",{name:"categorie_id",value:s.categorie_id,onChange:t=>a("categorie_id",t.target.value),onBlur:()=>o(),className:"w-full  select",children:[e.jsx("option",{value:"",children:"Sélectionner la catégorie"}),m.map(t=>e.jsx("option",{value:t.id,children:t.titre},t.id))]}),r.categorie_id&&e.jsx("p",{className:"mt-2 text-red-500 text-sm",children:r.categorie_id})]}),e.jsxs("div",{className:"relative",children:[e.jsx("label",{className:"label",children:"Tags"}),e.jsx("select",{name:"tags",multiple:!0,value:s.tags,onChange:t=>{const i=[...t.target.selectedOptions].map(y=>y.value);a("tags",i)},onBlur:()=>o(),className:"w-full dark:bg-gray-700 border-0 rounded-lg dark:text-white py-3 px-4 focus:ring-2 focus:ring-purple-500 focus:outline-none",children:p.map(t=>e.jsx("option",{value:t.id,children:t.nom},t.id))}),e.jsx("small",{className:"text-gray-400",children:"Maintenez Ctrl (Windows) ou Cmd (Mac) pour sélectionner plusieurs tags"}),r.tags&&e.jsx("p",{className:"mt-2 text-red-500 text-sm",children:r.tags})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-400",children:"Photo (optionnelle)"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"file",name:"image",ref:d,onChange:N,className:"absolute inset-0 w-full h-full opacity-0 cursor-pointer",accept:"image/*"}),e.jsx("div",{className:"bg-gray-700 rounded-lg p-4 text-center border-2 border-dashed border-gray-600 hover:border-purple-500 transition-colors",onClick:()=>d.current.click(),children:e.jsx("span",{className:"text-gray-400",children:s.image?"Image sélectionnée":"Glissez une image ou cliquez pour sélectionner"})})]}),r.image&&e.jsx("p",{className:"mt-2 text-red-500 text-sm",children:r.image})]}),e.jsx("div",{className:"h-48 bg-gray-700 rounded-lg overflow-hidden",children:u?e.jsx("img",{src:u,className:"w-full h-full object-cover",alt:"Aperçu"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center text-gray-500",children:"Aperçu de l'image"})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-400",children:"Votre Message *"}),e.jsx("textarea",{name:"contenus",value:s.contenus,onChange:t=>a("contenus",t.target.value),onBlur:()=>o(),rows:10,className:"w-full bg-gray-700 border-0 rounded-lg text-white py-3 px-4 focus:ring-2 focus:ring-purple-500 focus:outline-none"}),r.contenus&&e.jsx("p",{className:"mt-2 text-red-500 text-sm",children:r.contenus})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-400",children:"Code Source (optionnel)"}),e.jsx("textarea",{name:"codesource",value:s.codesource,onChange:t=>a("codesource",t.target.value),rows:10,className:"w-full bg-gray-700 border-0 rounded-lg text-white font-mono py-3 px-4 focus:ring-2 focus:ring-purple-500 focus:outline-none"}),r.codesource&&e.jsx("p",{className:"mt-2 text-red-500 text-sm",children:r.codesource})]})]}),e.jsx("button",{type:"submit",disabled:c,className:`w-full md:w-auto px-8 py-3 bg-gradient-to-r from-purple-500 to-pink-500 text-white font-medium rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 focus:ring-offset-2 focus:ring-offset-gray-900 transition-all ${c?"opacity-50 cursor-not-allowed":"hover:from-purple-600 hover:to-pink-600"}`,children:c?"Publication en cours...":"Publier"})]})]})})]})}export{A as default};
